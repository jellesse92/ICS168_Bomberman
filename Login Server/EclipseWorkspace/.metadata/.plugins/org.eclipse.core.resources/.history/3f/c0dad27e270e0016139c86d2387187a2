################################################################################
# Program:  Raging Hamsters Login Server
# Date:     2016 â€¢ 05 â€¢ 28
# Module:   data
################################################################################

import userClass

################################################################################

# File System:

def load_database() -> dict:
    """
    Opens and reads the database.txt and processing the data into a dictionary
    of users.
    """
    infile = open('database.txt', 'r')
    lines = infile.readlines()
    infile.close()

    database = dict()
    for line in lines:
        user = line.split()
        stats = user[2].split(':')
        for stat in stats:
            stat = int(stat)
        database[user[0]] = userClass.User(user[0], user[1], tuple(stats))

    return database

def save_database(database: dict):
    """
    Takes in a database and writes it into the database.txt file for saving.
    """
    outfile = open('database.txt', 'w')
    for user in database:
        line = str(user) + " " + str(database[user].password) + " "
        for stat in database[user].stats:
            line += str(stat) + ":"
            print('building line: ', line)
        line.strip(':')
        line += '\n'
        print ('writing line: ', line)
        outfile.write(line)

    outfile.close()
        
